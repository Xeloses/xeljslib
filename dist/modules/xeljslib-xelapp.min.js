/**
 * @name         XelJSlib
 * @description  Xeloses' JS library.
 * @version      0.0.2
 * @author       Xeloses (https://github.com/Xeloses)
 * @homepage     https://github.com/Xeloses/xeljslib
 * @license      GPL-3.0
 */(()=>{"use strict";const e=class{constructor(e=1,t={},_=null){const r="undefined"!=typeof GM_info&&"script"in GM_info;if(!Object.assign({preferLocalStorage:!1},t).preferLocalStorage&&r||!this.__isLocalStorageAvailable()){if(!r||!this.__isUserscriptStorageAvailable())throw new Error("Storage is unavailable.");this.removeValue="undefined"!=typeof GM_deleteValue?GM_deleteValue:GM&&void 0!==GM.deleteValue?GM.deleteValue:null,this.clearStorage=()=>{if("undefined"!=typeof GM_listValues?GM_listValues():GM&&void 0!==GM.listValues?GM.listValues():null)for(const e of this._getKeys())this.removeValue(e)}}else this.removeValue=localStorage.removeItem,this.clearStorage=localStorage.clear;this.__version__=this.__n(e),this.__cache__=new Map,this.__version__>Number.parseFloat(this.getValue("_v",0))&&(this.setValue("_v",this.__version__),_&&_(this))}__isUserscriptStorageAvailable(){return this.getValue="undefined"!=typeof GM_getValue?GM_getValue:GM&&void 0!==GM.getValue?GM.getValue:null,this.setValue="undefined"!=typeof GM_setValue?GM_setValue:GM&&void 0!==GM.setValue?GM.setValue:null,null!==this.getValue&&null!==this.setValue}__isLocalStorageAvailable(){if("undefined"!=typeof localStorage)try{let e=`test_${location.hostname.replace(".","-")}_${Date.now()}`;if(localStorage.setItem(e,"_OK_"),"_OK_"===localStorage.getItem(e))return localStorage.removeItem(e),this.getValue=localStorage.getItem,this.setValue=localStorage.setItem,!0}catch(e){throw new Error("Storage API is unsupported, or blocked by browser privacy settings.")}throw new Error("Storage API is unsupported.")}__n(e){if("number"==typeof e)return e;if(null===e||Number.isNaN(e))return 0;const t=/(\d+)\.(\d+)(\.\d+)?(\.\d+)?/.exec(e);return t?1e6*Number.parseFloat(t[1])+(void 0!==t[2]?1e3*Number.parseInt(t[2]):0)+(void 0!==t[3]?Number.parseInt(t[3].slice(1)):0)+(void 0!==t[4]?Number.parseFloat(t[4]):0):0}__t(e,t){if(this.__e__[e]&&this.__e__[e].length)return this.__e__[e].forEach((e=>e(t))),this}get version(){return this.__version__}has(e){if(this.__cache__.has(e))return!0;try{const t=this.get(e);return null!=t}catch(e){return!1}}get(e){try{const t={name:e,value:this.__cache__.has(e)?this.__cache__.get(e):JSON.parse(this.getValue(e,null))};return this.__t("read",t),null!==t.value&&void 0!==t.value&&this.__cache__.set(e,t.value),t.value}catch(e){throw new Error("Error reading data from Storage: {$e.message}")}}set(e,t){try{const _={name:e,value:t};return this.__t("write",_),null!==_.value&&void 0!==_.value?(this.__cache__.set(e,_.value),this.setValue(e,JSON.stringify(_.value))):this.delete(e),this}catch(e){throw new Error("Error writing data to Storage: {$e.message}")}}delete(e){const t={name:e,process:!0};return this.__t("delete",t),t.process&&(this.__cache__.delete(e),this.removeValue(e)),this}remove(e){return this.delete(e)}clear(){const e={process:!0};return this.__t("clear",e),e.process&&(this.__cache__.clear(),this.clearStorage()),this}addEventListener(e,t){return this.__e__[e]||(this.__e__[e]=[]),this.__e__[e].push(t),this}on(e,t){this.addEventListener(e,t)}};class t{constructor(e={},t={},_=null){const r=Object.assign({logHeaderColor:"c5c",logTextColor:"ddd",noConsole:!1,preferLocalStorage:!1},t),s="undefined"!=typeof GM_info&&"script"in GM_info?GM_info:e&&"script"in e?e:null;this.__is_userscript__=!!s,this.__name__=e.name||(this.__is_userscript__?s.script.name:"Script"),this.__version__=e.version||(this.__is_userscript__?s.script.version:"0.0.1"),this.__author__=e.author||(this.__is_userscript__?s.script.author:null),this.__description__=e.description||(this.__is_userscript__?s.script.description:null),this.__url__=e.url||(this.__is_userscript__?s.script.homepage:null),this.__namespace__=e.namespace||(this.__is_userscript__?s.script.namespace:(this.__author__?`${this.__author__.replace(/[^.\-\w]+/g,"")}.`:"")+this.__name__.replace(/[^.\-\w]+/g,"")),this.__unique_id__=this.__namespace__.replace(/[.\-\s]+/g,"_").replace(/[^\w]+/g,"").toLowerCase(),this.__is_mobile_device__=this.__isMobile(),this.__style__={header:`color:#${r.logHeaderColor};font-weight:bold;`,text:`color:#${r.logTextColor};font-weight:normal;`},this.__no_console__=r.noConsole,this.__prefer_local_storage__=r.preferLocalStorage,_&&(this.__onStorageUpgrade__=_)}__initStorage(){try{return this.__storage__=new e(this.__version__,{preferLocalStorage:this.__prefer_local_storage__},this.__onStorageUpgrade__),this.__storage_}catch(e){const t=`Unable to initialize app storage: ${e.message}`;throw this.logError(t),new Error(t)}}__isMobile(){if("maxTouchPoints"in navigator)return navigator.maxTouchPoints>0;if("msMaxTouchPoints"in navigator)return navigator.msMaxTouchPoints>0;{let e=window.matchMedia&&matchMedia("(pointer:coarse)");if(e&&"(pointer:coarse)"===e.media)return!!e.matches;if("orientation"in window)return!0;if("userAgent"in navigator&&navigator.userAgent)return/\b(Android|Windows Phone|iPhone|iPad|iPod|webOS|BlackBerry|Opera Mini|IEMobile)\b/i.test(navigator.userAgent)}}get name(){return this.__name__}get appName(){return this.__name__}get version(){return this.__version__}get ver(){return this.__version__}get author(){return this.__author__}get description(){return this.__description__}get url(){return this.__url__}get homepage(){return this.__url__}get namespace(){return this.__namespace__}get ns(){return this.__namespace__}get prefix(){return this.__unique_id__}get unique(){return this.__unique_id__}get isUserscript(){return this.__is_userscript__}get isMobile(){return this.__is_mobile_device__}get storage(){return"__storage__"in this?this.__storage__:this.__initStorage()}waitPageLoading(e,t){document.querySelector(e)?t():setTimeout(this.waitPageLoading(e,t),330)}createNode(e="DIV",t=null,_=null,r=null){if(null===e||"TEXT"===e.toUpperCase())return document.createTextNode(t||"");{const s=r?document.createElementNS(r,e):document.createElement(e);if(r&&"SVG"==e.toUpperCase()&&s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),_)for(const[e,t]of Object.entries(_))if("data"==e)for(const[e,_]of Object.entries(t))s.dataset[e]=_;else s.setAttribute(e,t);return t&&(Array.isArray(t)?t.forEach((e=>{s.appendChild("string"==typeof e?document.createTextNode(e):e)})):s.appendChild("string"==typeof t?document.createTextNode(t):t)),s}}injectCSS(e,t=null,_=null,r=!1){if(document.querySelector(t))return;e=(r?e:e.replace(/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,"")).replace(/[\t\n]/g," ").replace(/[\s]{2,}/g," ");let s=this.createNode("STYLE",e,{type:"text/css"});return t&&(s.id=t),_&&(s.media=_),document.head.appendChild(s),s}log(e){this.__no_console__||console.log(`%c[${this.name}]%c ${e}`,this.__style__.header,this.__style__.text)}dump(e,t=null){this.__no_console__||(t&&this.log(t),console.log(e))}logInfo(e){this.__no_console__||console.info(`%c[${this.name}]%c ${e}`,this.__style__.header,`${this.__style__.text}font-style:italic;`)}logWarn(e){this.__no_console__||console.warn(`%c[${this.name}]%c ${e}`,this.__style__.header,this.__style__.text)}logError(e){this.__no_console__||console.error(`%c[${this.name}]%c ${e}`,this.__style__.header,this.__style__.text)}logInit(){this.logInfo(`App loaded (version: ${this.version})`)}}!function(e){for(const t in e){const _=t.replace(/[^\w]+/g,"_").replace(/_+/g,"_");"undefined"!=typeof unsafeWindow&&(unsafeWindow[_]=e[t]),"undefined"!=typeof window&&(window[_]=e[t])}}({XelApp:t})})();
//# sourceMappingURL=xeljslib-xelapp.min.js.map